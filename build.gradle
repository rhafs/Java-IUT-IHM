apply plugin: "java"

class JarTask extends Jar {
    String jarName = "default"
    String jarVersion = "1.0.0"

    @TaskAction
    def jar() {
        baseName = jarName
        version = jarVersion
        String className = baseName.capitalize()

        from(sourceSets.main.output) {
            include "$baseName/**"
            include "$baseName/**"
        }

        from {
            configurations.compile.collect {
                it.isDirectory() ? it : zipTree(it)
            }
        }

        manifest {
            attributes "Implementation-Title": "$className",
                    "Implementation-Version": "$version",
                    "Main-Class": "$baseName.$className"
        }
    }
}

task jarCalculatrice(type: JarTask) {
    jarName = "calculatrice"
}

task jarCopier(type: JarTask) {
    jarName = "copier"
    version = "1.2.42"
}
